## To install ESS for all users on your unix system:
## 1. Check variables below, edit as necessary
## 2. make
## 3. make install

## Section 1
## Installation variables for your Emacs variant
##
## Variable        Description
## EMACS           Path to GNU Emacs
## EMACSBATCH      How to run Emacs as batch
## SITELISP        Destination of site-lisp
## ESSDIR          Destination of ESS
## JULIA_DIR       Path to julia-mode
DESTDIR ?= /usr
PREFIX ?= $(DESTDIR)

##__ GNU Emacs __
EMACS ?= emacs
SITELISP ?= $(PREFIX)/share/emacs/site-lisp
ESSDIR ?= $(SITELISP)/ess
EMACSBATCH ?= $(EMACS) -batch -Q -L $(JULIA_DIR)

# Load path:
ifndef JULIA_DIR

ELPA_DIR ?= ~/.emacs.d/elpa

JULIA_DIR ?= $(shell \
  find -L $(ELPA_DIR) -maxdepth 1 -regex '.*/julia-mode-[.0-9]*' 2> /dev/null | \
  sort | tail -n 1)
ifeq "$(JULIA_DIR)" ""
  JULIA_DIR = $(SITELISP)
endif

endif

##__ GNU Emacs __  for Mac OS X with NeXTstep (Cocoa or GNUstep)
# PREFIX=/Applications/Emacs.app/Contents/Resources
# EMACS=/Applications/Emacs.app/Contents/MacOS/Emacs
# SITELISP=$(PREFIX)/site-lisp
# LISPDIR=$(SITELISP)/ess
# INFODIR=/usr/local/info
# ETCDIR =$(PREFIX)/etc/ess

##__ Aquamacs __  (donated by Dan Knoepfle, Mar 26, 2011)
# PREFIX=/Applications/Aquamacs.app/Contents/Resources/lisp/aquamacs/edit-modes
# EMACS=/Applications/Aquamacs.app/Contents/MacOS/Aquamacs
# SITELISP=/Applications/Aquamacs.app/Contents/Resources/lisp
# LISPDIR=$(PREFIX)/ess-mode/lisp
# INFODIR=/Applications/Aquamacs.app/Contents/Resources/info
# ETCDIR=$(PREFIX)/ess-mode/etc

## COMPILE-FLAGS is set in tests
COMPILE ?= $(EMACSBATCH) $(COMPILE-FLAGS) --directory . --directory ./obsolete -f batch-byte-compile
COMPILE-SIMPLE ?= $(EMACSBATCH) --directory . --directory ./obsolete -f batch-byte-compile

## Section 2
## Installation variables for your unix variant
##
## Variable        Description
## MAKEINFO        program to convert .texi{nfo} to .info
## MAKEHTML        program to convert .texi{nfo} to .html
## MAKETXT         program to convert .texi{nfo} to .txt
## INSTALLDIR      to create directories, if necessary
## INSTALL         to copy files, file copying commands expect 2 args:
##                 1st) source-file & 2nd) target-directory
## UNINSTALL       deletes all arguments
## DOCDIR          Destination of other doc files
## DOWNLOAD        Download internet file to stdout

MAKEINFO ?= LC_ALL=C LANG=en makeinfo
MAKEHTML ?= $(MAKEINFO) --html --no-split --css-include=atouchofstyle.css -o
MAKETXT  ?= $(MAKEINFO) --no-validate --plaintext --no-split -o -
INSTALLDIR ?= mkdir -p
INSTALL ?= cp -p
UNINSTALL ?= rm -f
TEXI2PDF ?= LANG=C texi2dvi --pdf
DOWNLOAD ?= $(shell which wget > /dev/null && echo 'wget -qO -' || which curl)
INSTALLINFO ?= install-info

## Section 3
## For ESS developers only, not part of installation procedure
##
## Variable        Description
## ESSVERSION      set to the contents of VERSION
## ESSDIR          ess- prepended to ESSVERSION
## ESSVERSIONTAG   repository tags cannot contain .'s (no longer used)
## GNUTAR          the name of GNU tar to support the z option
## SVN_URL         SVN repository URL (repo retired)
## UPLOAD_DIR      Martin's upload directory
## ESS_HOMEPAGE    Martin's svn co https://svn.r-project.org/ESS-web/trunk
##

GNUTAR=tar
# SVN_URL = https://svn.r-project.org/ESS
UPLOAD_DIR = /u/maechler/emacs/ess-WWW/downloads/ess
ESS_HOMEPAGE = /u/maechler/emacs/ESS-web

GPG=$(shell (gpg2 --version > /dev/null 2>&1 && echo gpg2 ) || echo gpg )

.SUFFIXES: .i3 .m3 .nw .tex .dvi .html .c .h .el .elc

# Local Variables:
# mode: makefile-gmake
# End:
